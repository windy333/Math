```matlab
function [C,L,v]=lagran(x,y,u)

%x是横坐标，y是纵坐标,u是要估计的点的横坐标
%C返回插值系数，降幂，L返回每个基函数的系数，降幂.v返回u对应的估计值。

%u可以是矩阵：x=[0 1 2 4];y=[1 9 23 3];u=[0.2 1.2 2.2];[C,L,v]=lagran(x,y,u);
%例7程序：x=[0.32 0.34 0.36];y=[0.314567 0.333487 0.352274];u=0.3367;[C,L,v]=lagran(x,y,u)

%x=-5:1:5;
%y=5./(1+x.^2);
%u=-5:0.1:5;
%[C,L,v]=lagran(x,y,u);
%plot(u,v,'.-',x,y,'*-')    
%legend('插值节点','原函数点')
%grid on
%title('拉格朗日插值')


% poly()函数是用于求以向量为解的方程或方阵的特征多项式，可以直接传递多项式方程的系数矩阵。
%poly([1 2 3])使用的举例。P=poly([1 2 3]) 可以解出P=[1 -6 11 -6]，即求得方程为：x^3-6*x^2+11*x-6=0。
%polyval 计算在x中任意元素处的多项式p的估值。例如对多项式p(x)=1+2*x+3*x^2，计算在x=5,7,9的值。
%输入 x=[5,7,9];p=[3,2,1];polyval(p,x)     结果为：ans =86 162 262
% con()计算两个表达式2x+1和x+1的乘积展开式的系数
%输入 u=[2,1]; v=[1,1];w=conv(u,v); 输出为 w = 2     3     1


w=length(x);
n=w-1;
L=zeros(w,w);
%形成拉格朗日系数多项式
for k=1:n+1
    V=1;
    for j=1:n+1
       if k~=j
        V=conv(V,poly(x(j)))/(x(k)-x(j));
       end
    end
    L(k,:)=V;
end
C=y*L;
v=polyval(C,u);

```